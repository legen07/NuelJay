import g from"fs";import r from"path";import{inputFormats as a}from"./constants.js";import f from"ini";import{writeFileSync as c}from"node:fs";function z(e,n){return e.startsWith(".")&&(e=e.substring(1)),n?n[e]:void 0}function m(e){return e?a.includes(e):!1}function E(e){const n=new Set;function t(o){const i=r.join(process.cwd(),o);l("Searching for images in "+r.resolve(i),!0),g.readdirSync(i).forEach(p=>{const u=r.join(o,p);if(g.statSync(u).isDirectory())t(u);else{let s=r.parse(p).ext.toLowerCase();s.startsWith(".")&&(s=s.substring(1)),m(s)&&n.add(s)}})}return t(e),[...n]}function l(e,n=!1){n&&console.log(e)}function R(e,n){if(!e)return n;let t="."+e;switch(e){case"jpg":case"mozjpeg":t=".jpg";break}return n!==t?t:""}function k(e,n){switch(n){case"jpg":case"jpeg":return e??"mozjpeg";case"svg":return"svgo";default:return e??"webp"}}function D(e,n){return n===".svg"?void 0:e||80}function G(e){return e??!0}function N(e){return e?e.map(n=>n.trim()):["preset-default"]}function T(e){return{plugins:e??["preset-default"]}}function d(e){e||(e=a);const n={};return e.forEach(t=>{t==="svg"?n[t]={compressor:"svgo",plugins:["default"]}:t==="gif"?n[t]={compressor:"webp",animation:!0,quality:80}:n[t]={compressor:"avif",quality:50}}),n}function J(e="replace",n,t){t==="mozjpeg"&&(t="jpg");const o="."+t;return e==="add"&&n?.ext!==o?n?.base+o:n?.name+o}function q(e,n){const t={verbose:n.verbose==="true",extMode:n.extMode||"replace",maxSize:Number(n.maxSize)||void 0,resizeType:n.resizeType||void 0},o={path:{in:n.input??"images",out:n.output??"optimized"},options:JSON.parse(JSON.stringify(t)),...d(),svg:{compressor:"svgo",plugins:"defaults"}},i=f.stringify(o);return c(e,i)}export{m as asInputFormats,d as defaultCompressionOptions,q as generateDefaultConfigFile,z as getCompressionOptions,k as getDefaultCompressor,J as getFileName,E as getImageFormatsInFolder,G as getJpgCompressionOptions,R as getOutputExtension,D as getQuality,T as getSvgoOptions,N as getSvgoPluginOptions,l as logMessage};
